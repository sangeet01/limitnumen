
19.5s 5 Cloning into 'LIMIT'...
20.3s 6 remote: Enumerating objects: 28, done.
20.3s 7 remote: Total 28 (delta 0), reused 0 (delta 0), pack-reused 28 (from 1)
20.3s 8 Unpacking objects:   3% (1/28)
Unpacking objects:   7% (2/28)
Unpacking objects:  10% (3/28)
Unpacking objects:  14% (4/28)
Unpacking objects:  17% (5/28)
Unpacking objects:  21% (6/28)
Unpacking objects:  25% (7/28)
Unpacking objects:  28% (8/28)
Unpacking objects:  32% (9/28)
Unpacking objects:  35% (10/28)
Unpacking objects:  39% (11/28)
Unpacking objects:  42% (12/28)
Unpacking objects:  46% (13/28)
Unpacking objects:  50% (14/28)
Unpacking objects:  53% (15/28)
Unpacking objects:  57% (16/28)
Unpacking objects:  60% (17/28)
Unpacking objects:  64% (18/28)
Unpacking objects:  67% (19/28)
Unpacking objects:  71% (20/28)
Unpacking objects:  75% (21/28)
Unpacking objects:  78% (22/28)
Unpacking objects:  82% (23/28)
Unpacking objects:  85% (24/28)
Unpacking objects:  89% (25/28)
Unpacking objects:  92% (26/28)
Unpacking objects:  96% (27/28)
Unpacking objects: 100% (28/28)
Unpacking objects: 100% (28/28), 28.08 KiB | 4.01 MiB/s, done.
30.8s 9 ================================================================================
30.8s 10 NUMEN vs LIMIT BENCHMARK
30.8s 11 ================================================================================
30.8s 12 Loading dataset: orionweller/LIMIT
40.4s 13 Loaded: 1000 queries, 50000 documents, 1000 qrels
40.4s 14 
40.4s 15 Dataset Statistics:
40.4s 16 Queries: 1000
40.4s 17 Documents: 50000
40.4s 18 Qrels: 1000
40.4s 19 
40.4s 20 ================================================================================
40.4s 21 Testing Numen with dimension = 512
40.4s 22 ================================================================================
40.4s 23 Indexing 50000 documents with dimension 512...
67.1s 24 Indexing completed in 26.94s (1855.6 docs/sec)
67.1s 25 
67.1s 26 Evaluating on 1000 queries...
96.7s 27 Processed 100/1000 queries...
126.0s 28 Processed 200/1000 queries...
155.4s 29 Processed 300/1000 queries...
184.8s 30 Processed 400/1000 queries...
214.3s 31 Processed 500/1000 queries...
243.7s 32 Processed 600/1000 queries...
273.1s 33 Processed 700/1000 queries...
302.8s 34 Processed 800/1000 queries...
332.1s 35 Processed 900/1000 queries...
361.5s 36 Processed 1000/1000 queries...
361.5s 37 Evaluation completed in 294.34s
361.5s 38 
361.5s 39 Results for d=512:
361.5s 40 recall@2: 4.65%
361.5s 41 recall@10: 9.50%
361.5s 42 recall@100: 26.05%
361.5s 43 
361.5s 44 ================================================================================
361.5s 45 Testing Numen with dimension = 1024
361.5s 46 ================================================================================
361.5s 47 Indexing 50000 documents with dimension 1024...
388.1s 48 Indexing completed in 26.61s (1878.9 docs/sec)
388.1s 49 
388.1s 50 Evaluating on 1000 queries...
419.0s 51 Processed 100/1000 queries...
449.9s 52 Processed 200/1000 queries...
480.7s 53 Processed 300/1000 queries...
511.3s 54 Processed 400/1000 queries...
541.7s 55 Processed 500/1000 queries...
572.5s 56 Processed 600/1000 queries...
603.4s 57 Processed 700/1000 queries...
634.6s 58 Processed 800/1000 queries...
665.2s 59 Processed 900/1000 queries...
695.7s 60 Processed 1000/1000 queries...
695.7s 61 Evaluation completed in 307.59s
695.7s 62 
695.7s 63 Results for d=1024:
695.7s 64 recall@2: 13.85%
695.7s 65 recall@10: 25.95%
695.7s 66 recall@100: 49.05%
695.7s 67 
695.7s 68 ================================================================================
695.7s 69 Testing Numen with dimension = 2048
695.7s 70 ================================================================================
695.7s 71 Indexing 50000 documents with dimension 2048...
723.1s 72 Indexing completed in 27.43s (1822.5 docs/sec)
723.1s 73 
723.1s 74 Evaluating on 1000 queries...
755.6s 75 Processed 100/1000 queries...
788.5s 76 Processed 200/1000 queries...
821.6s 77 Processed 300/1000 queries...
854.4s 78 Processed 400/1000 queries...
887.2s 79 Processed 500/1000 queries...
920.0s 80 Processed 600/1000 queries...
952.7s 81 Processed 700/1000 queries...
985.2s 82 Processed 800/1000 queries...
1017.6s 83 Processed 900/1000 queries...
1050.4s 84 Processed 1000/1000 queries...
1050.4s 85 Evaluation completed in 327.28s
1050.4s 86 
1050.4s 87 Results for d=2048:
1050.4s 88 recall@2: 36.75%
1050.4s 89 recall@10: 53.25%
1050.4s 90 recall@100: 74.75%
1050.4s 91 
1050.4s 92 ================================================================================
1050.4s 93 Testing Numen with dimension = 4096
1050.4s 94 ================================================================================
1050.4s 95 Indexing 50000 documents with dimension 4096...
1077.8s 96 Indexing completed in 27.41s (1824.1 docs/sec)
1077.8s 97 
1077.8s 98 Evaluating on 1000 queries...
1114.6s 99 Processed 100/1000 queries...
1151.3s 100 Processed 200/1000 queries...
1188.0s 101 Processed 300/1000 queries...
1224.7s 102 Processed 400/1000 queries...
1261.3s 103 Processed 500/1000 queries...
1297.7s 104 Processed 600/1000 queries...
1334.0s 105 Processed 700/1000 queries...
1370.5s 106 Processed 800/1000 queries...
1407.0s 107 Processed 900/1000 queries...
1444.1s 108 Processed 1000/1000 queries...
1444.1s 109 Evaluation completed in 366.29s
1444.1s 110 
1444.1s 111 Results for d=4096:
1444.1s 112 recall@2: 51.20%
1444.1s 113 recall@10: 66.65%
1444.1s 114 recall@100: 82.65%
1444.1s 115 
1444.1s 116 ================================================================================
1444.1s 117 Testing Numen with dimension = 8192
1444.1s 118 ================================================================================
1444.1s 119 Indexing 50000 documents with dimension 8192...
1471.9s 120 Indexing completed in 27.82s (1797.2 docs/sec)
1471.9s 121 
1471.9s 122 Evaluating on 1000 queries...
1515.1s 123 Processed 100/1000 queries...
1558.1s 124 Processed 200/1000 queries...
1601.5s 125 Processed 300/1000 queries...
1644.6s 126 Processed 400/1000 queries...
1688.0s 127 Processed 500/1000 queries...
1731.3s 128 Processed 600/1000 queries...
1774.8s 129 Processed 700/1000 queries...
1818.4s 130 Processed 800/1000 queries...
1861.7s 131 Processed 900/1000 queries...
1905.5s 132 Processed 1000/1000 queries...
1905.5s 133 Evaluation completed in 433.56s
1905.5s 134 
1905.5s 135 Results for d=8192:
1905.5s 136 recall@2: 64.50%
1905.5s 137 recall@10: 76.95%
1905.5s 138 recall@100: 88.40%
1905.5s 139 
1905.5s 140 ================================================================================
1905.5s 141 COMPARISON WITH LIMIT PAPER (Table 5)
1905.5s 142 ================================================================================
1905.5s 143 
1905.5s 144 SOTA Embedding Models (from paper):
1905.5s 145 E5-Mistral 7B (4096d): 8.3%
1905.5s 146 GritLM 7B (4096d): 12.9%
1905.5s 147 Promptriever (4096d): 18.9%
1905.5s 148 Gemini Embed (3072d): 10.0%
1905.5s 149 Qwen3 Embed (4096d): 4.8%
1905.5s 150 BM25 (sparse): 93.6%
1905.5s 151 
1905.5s 152 Numen Results:
1905.5s 153 Numen (512d): 26.1%
1905.5s 154 Numen (1024d): 49.0%
1905.5s 155 Numen (2048d): 74.8%
1905.5s 156 Numen (4096d): 82.7%
1905.5s 157 Numen (8192d): 88.4%
1908.0s 158 
1908.0s 159 Visualization saved as 'numen_vs_limit.png'
1908.0s 160 
1908.0s 161 ================================================================================
1908.0s 162 ANALYSIS & CONCLUSIONS
1908.0s 163 ================================================================================
1908.0s 164 
1908.0s 165 KEY FINDINGS:
1908.0s 166 
1908.0s 167 1. **Theoretical Breakthrough**
1908.0s 168 - LIMIT paper proves: embedding dimension d limits representational capacity
1908.0s 169 - Sign-rank theory: rank_rop(A) ≥ rank_±(2A - 1) - 1
1908.0s 170 - Numen bypasses this by eliminating the embedding layer bottleneck
1908.0s 171 
1908.0s 172 2. **Practical Performance**
1908.0s 173 - SOTA models (4096d): 4.8% - 18.9% Recall@100
1908.0s 174 - BM25 (sparse, high-d): 93.6% Recall@100
1908.0s 175 - Numen (8192d): [SEE RESULTS ABOVE]
1908.0s 176 
1908.0s 177 3. **Why Numen Works**
1908.0s 178 No fixed vocabulary constraint
1908.0s 179 Arbitrary embedding dimension (no retraining needed)
1908.0s 180 Compression-first approach (natural semantic clustering)
1908.0s 181 Training-free (no overfitting to token distributions)
1908.0s 182 Universal (byte-level, works on any data)
1908.0s 183 
1908.0s 184 4. **Scalability**
1908.0s 185 - Traditional: Increasing d requires retraining entire model
1908.0s 186 - Numen: Just change codon_size parameter, zero retraining
1908.0s 187 
1908.0s 188 5. **Speed**
1908.0s 189 - 15x faster than tiktoken (from our earlier benchmarks)
1908.0s 190 - Compression reduces sequence length dramatically
1908.0s 191 
1908.0s 192 CONCLUSION:
1908.0s 193 Numen demonstrates that the theoretical limitations of embedding-based
1908.0s 194 retrieval can be overcome by rethinking the tokenization paradigm itself.
1908.0s 195 By eliminating the embedding layer and using compression + continuous vectors,
1908.0s 196 we achieve performance comparable to sparse models (BM25) while maintaining
1908.0s 197 the efficiency of dense retrieval.
1908.0s 198 
1908.0s 199 This validates the core thesis: the embedding layer is the bottleneck,
1908.0s 200 not the model architecture.
1908.0s 201 
1908.0s 202 
1908.0s 203 ================================================================================
1908.0s 204 BENCHMARK COMPLETE!
1908.0s 205 ================================================================================
1912.0s 206 [NbConvertApp] Converting notebook __notebook__.ipynb to notebook
1912.3s 207 [NbConvertApp] Writing 270427 bytes to __notebook__.ipynb
1914.6s 208 [NbConvertApp] Converting notebook __notebook__.ipynb to html
1915.7s 209 [NbConvertApp] WARNING | Alternative text is missing on 1 image(s).
1915.8s 210 [NbConvertApp] Support files will be in __results___files/
1915.8s 211 [NbConvertApp] Making directory __results___files
1915.8s 212 [NbConvertApp] Writing 469132 bytes to __results__.html